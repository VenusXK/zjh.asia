# 2024年山大预测3分析

[[TOC]]

## 选择题

### 01 DMA传输

> 采用 DMA 方式传送数据时，每传送一个数据就要用一个 ______ 时间。
> 
> A. 指令周期  B. 机器周期 C. 存储周期 D. 总线周期

**模拟题答案为D**，认为应该为占用一个总线周期，因为DMA传输时，CPU让出总线。**但牛客上给出答案为C**，理由是DMA获得内存总线的控制权，单纯的是为了做内存访问，所以仅需要一个存取周期。

王道在介绍DMA传送方式时，介绍周期挪用，讲IO设备和CPU同时访存时，CPU暂时让出总线，IO设备挪用一个或几个**存取周期**，传送完一个数据后立刻释放总线，因为IO设备不立即访存就可能会丢失数据，所以优先级高于CPU。

### 02 指令字长 机器字长 存储字长 取指周期 机器周期 时钟周期

> 下列说法中，正确的是( )。
>
> I. 指令字长等于机器字长的前提下，取指周期等于机器周期
> 
> II. 指令字长等于存储字长的前提下，取指周期等于机器周期
> 
> III. 指令字长和机器字长的长度没有任何关系
> 
> IV 为了硬件设计方便，指令字长都和存储字长一样大
>
> A.`II III` B.`II III IV` C.`I III IV` D.`I IV`

在王道中写过这道题，但是对机器周期和取指周期的定义不是很清楚，所以这里再次总结一下。

关于字长的定义：

- **机器字长**：CPU一次能够处理的数据的位数，通常等于寄存器的位数。例子：windows 64位/32位，这里的64位和32位指的就是该操作系统的机器字长
- **存储字长**：计算机存储器中一个存储单元可以存储的位数。例子：某某计算机按照字节编址，即说明该计算机的存储字长为1B=8位
- **指令字长**：计算机内一条指令的位数。这里通常指的定长指令

关于访存周期和机器周期：

- **访存周期**：两次访问操作（指访问一个存储单元）所需的时间间隔就是访问周期
- **机器周期**：通常用访问周期来确定机器周期，即机器周期可以认为等于访问周期，包含若干时钟周期
- **存储字长与访存周期**：1个存储字长的数据需要1个访存周期(机器周期)
- **取指周期**：指令字长等于n倍的存储字长，需要n个访存周期(机器周期)

### 03 小端存储 LSB 和 MSB

某计算机按字节编址，采用小端

> 某计算机按字节编址，采用小端方式存储信息。其中，某指令的一个操作数为 16 位，该操作数采用基址寻址方式，指令中形式地址（用补码表示）为 FF00H ，当前基址寄存器的内容为 C000 0000H ，则该操作数的 LSB 存放的地址是（）
> 
> A. `BFFF FF00H` B. `BFFF FF01H` C. `C000 FF00H` D. `C000 FF01H`

我对LSB和MSB的理解不够深刻，虽然能够写出如何存储，但不知道哪一端是LSB，哪一端是MSB。

- **MSB（Most Significant Bit）**：最高有效位，二进制中代表**最高值**的比特位，对数值的影响最大
- **LSB（Least Significant Bit）**：最低有效位，二进制中代表**最低值**的比特位，对数值的影响最小

例如，在二进制的1001（十进制的9）中，最左边的“1”即是MSB对数值影响最大，从1到9的变化幅度。而最右边的1是LSB因为仅会让数值产生8到9的变化。

假设存放 1234H，小端存储表示末尾字节在小端，这道题写出存储地址，存储如下：

| BFFF FF00 | BFFF FF01 |
| :---:     | :---:     |
| 34        | 12        |

则LSB为34，在 BFFFFF00H 地址位置。

### 05 浮点小数的表示范围

> 设浮点数的阶码用移码表示，尾数用补码表示，阶码的底数为 2 ，阶码长度为 3 位(含符号位)，尾数长度为 5 位(含符号位)，则其能表示的最小整数为是（ ）。
>
> A. -8 B. -7.5 C. -128 D. -256

首先，我困惑在移码的表示范围上，不知道移码是在原码的基础上增加偏移量还是在补码的基础上增加偏移量，正确答案是**在补码的基础上增加偏移量**。

假设字长 8 位，移码增加 $2^7$，即增加 $1000,0000$ ：

- **例1**：真值表示为 $+ 0001,0101(21)$ 变为 $+ 1001,0101(149)$ (其没有符号位)
- **例2**：真值表示为 $- 0001,0101(-21)$  计算过程为 $2^7 + ( - 0001,0101 )$，转为补码加减，即 $1000,0000 + 1110,1011$，为 $0110,1011$ (其没有符号位) 。

可以看到，其在补码的基础上增加了偏移量，设其中 $n$ 为字长：

- 补码表示范围：最小为 $1000,0000(-2^{n-1})$ ，最大为 $0111,1111(2^{n-1}-1)$
- 移码表示范围：最小为 $0000,0000(-2^{n-1})$ ，最大为 $1111,1111(2^{n-1}-1)$

补码零的表示唯一，因此移码零的表示也唯一，为 $1000,0000$ 。

阶码长度为3位，说明其表示范围为 $-2^2 \sim 2^2-1$ ，尾数长度为5位，说明其表示范围为 $-(2-2^{-5}+2^{-5}) \sim 2-2^{-5}$，注意尾码用补码表示，多表示一位，该位为最低位，为 $2^{-5}$。

因此最小的数即为 $-2\times2^{2^2-1}$，为 $-8$，选A。

### 06 硬盘读取

> 硬盘平均寻道时间为 12ms，传输速率为 10 MB/s，磁盘控制器延时为 2 ms，则一个转速为 7200 转/分钟的磁盘写1KB数据的时间为？()。
>
> A. 13.11ms B. 14.13ms C. 15.15ms D. 18.27ms

一次磁盘读写操作的时间由**寻道时间**、**旋转延迟**时间和**传输时间**决定，这道题增加了磁盘控制器延时。

判断1Kb是否在一个磁道上，如果在一个磁道上，只需要一次寻道，否则需要多次寻道，需要计算每转容量，判断是否大于1KB。

120r/s，每转容量为 10MB/120r = 83.33KB > 1KB，因此只需要一次寻道。

- **旋转延迟**：磁盘转速为 7200 转/分钟，即 120 转/秒，每转 1/120s，即 8.33ms，取平均值为半圈时间，即 4.16ms
- **寻道时间**：题给 12ms
- **传输时间**：1KB数据，传输速率为 10 MB/s，即 10KB/ms，传输时间为 0.1ms
- **磁盘控制器延时**：题给 2 ms

总共为 18.26ms，选D。

**牛客类似题**

> 若磁盘转速是7200转/分，平均寻道时间是8ms，每个磁道包含1000个扇区，则访问一个扇区的平均存取时间为？（）
> 
> A. 8.1ms B. 12.2ms C. 16.3ms D. 20.4ms

相对更简单，平均寻道时间为 8ms，旋转延迟为 4.16ms，总共为 12.26ms，选B。

### 07 PROM EPROM EEPROM

> 下面关于各种存储器的说法中正确的有（）。
> 
> I. 静态RAM不是易失性存储器，而动态RAM是易失性存储器
>
> II. PROM只能写一次
>
> III. EPROM是可改写的，并且也是随机存储器的一种
>
> IV. EEPROM是可写存储器
>
> A. I、II B. II、IV C. I、II、III D. II、III、IV

存储器分为：

- 静态随机存取存储器(Static Random Access Memory，SRAM)
- 只读存储器(Read Only Memory, ROM)

一些关于随机存取器、随机访问的辨别：

- **随机存取存储器**：支持在运行时随机读**写**数据，断电后数据丢失，如DRAM、SRAM
- **ROM不是随机存储器**：修改通常需要特殊的操作，并且不具有与RAM相似的灵活性和速度
- **RAM和ROM都支持随机访问**：与顺序访问存储器（如磁带）不同，可以通过直接访问存储器中的任意地址来读取或写入数据，因此被称为随机访问

一些对RAM的补充知识：

| 特点\类型|  SRAM  |  DRAM  |
|:---:    |  :---: | :---:  |
| 存储信息 | 触发器  |  电容  |
| 破坏性读 | 无    |  有    |
| 需要刷新 | 无    |  需要  |
| 送行列地址| 同时 | 分开，复用|
| 运行速度 | 快    |  慢    |
| 集成度   | 低    |  高    |
| 存储成本 | 高    |  低    |
| 主要用途 | 高速缓存| 主存  |

DRAM和SRAM价格区别根本在集成度，SRAM集成度低硅片要求多，因此贵。

一些对ROM的补充知识：

- **MROM**：只读存储器，只能写入一次，写入后不能修改
- **PROM**：可编程只读存储器，只能写入一次，写入后不能修改
- **EPROM**：可擦除可编程只读存储器，可以擦除后重新写入，编程次数有限，写入时间长
- **Flash**：由EPROM和EEPROM发展而来，可以擦除后重新写入，可快速擦除重写
- **SSD**：由控制单元和存储单元Flash组成




## 简答题

### 01 Cache 容量计算

> 假设主存地址位数为32位，按字节编址，主存和Cache之间采用全相联映射方式，主存块大小为1个字，每字32位，采用回写（write back）方式和随机替换策略，则能存放32K字数据的Cache的总容量至少应有多少位？

我的困惑在于，不知道Cache的字块内地址是否存储，如何存储，在计算容量的时候以为有个字段专门记录字块内地址，因此计算出来的容量不对。

**块内地址字段没有被实际存储，而是通过主存地址的位划分和提取来计算的**。当主存地址的块内地址字段提取出来时，这个块内地址字段的值就是用于在缓存行内定位具体位置的偏移量。

相对于存储器先传输地址，再读取数据，Cache一旦确定了行的位置，实际的读取就在这个位置上进行，而不需要再次传输地址，直接根据块内地址字段返回数据。

因此，Cache的容量计算为：

| 标记位 | 有效位 | 写回位 | 替换位 | 数据块 |
| :---: | :---: | :---: | :---: | :---: |
| 控制字段 | 控制字段 | 控制字段 | 控制字段 | 数据字段 |

本题计算为 $(32K+32K)\times 32 = 2M$ 位。

如果问Cache字地址为多少，这里即求块内地址，比如36A8H，块内地址为 A8H，则字块内地址为 A8H。